---
title: "COCKTAIL CLOUDでのストレージボリュームのスケールアップ方法"
excerpt: ""
permalink: /docs/ja/8.4.8/
redirect_from:
  - /theme-setup/
toc: false
toc_sticky: false
sidebar:
  nav: "ja"
---

---
ワークロードがストレージボリューム (Persistent Volume) を使用中、容量が不足した際に、ストレージの容量を拡張する場合は、カクテルで以下のように対応すればよい。

kubernetes では、いくつかのクラウドプロバイダーのストレージクラスを通じて PVC のリクエスト量を増やすと、PVとそのストレージの容量が自動的に拡張される。この際、PV は Capacity 量が調整され、接続されたストレージはプロビジョニングを通じてスケールアップされる。
但し、このように調整されたリクエスト量が Pod に反映されるため、マウントした Pod を再起動しなければならない。

カクテルクラウドは、サービスのストレージボリューム画面で該当ボリュームのリクエスト量を変更すると、kubernetes と同じ方法でボリュームを拡張することができる。
但し、該当ボリュームをマウントしたワークロードは再起動しなければならない。

容量拡張ができるようにストレージクラスがサポートされているプロバイダーストレージ以外は、ストレージ自体を拡張し、上記の様な作業を行わなければならない。

代表的な例は、NFS ストレージである。

カクテルクラウドで NFS プラグインタイプ (NFS, NFS Named) のストレージは、ストレージクラスを通じて該当ストレージが拡張されることができないので、ストレージ拡張からしなければならない。

NFSストレージの拡張は、以下コマンドを使用して行う。

```
# NFS ストレージが運用されているホストにログイン後、ストレージデバイス名を照会

$ lsblk
NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT sda 8:0020G0disk
└─sda1 8:1 0 20G 0 part /
sdb 8:16 0 100G 0 disk /storage

# sda デバイスの容量を拡張
$ xfs_growfs /dev/sdb -D 40G

```

上記コマンドで、ストレージデバイスの容量を拡張後、カクテルクラウドのクラスターメニューのストレージ画面で以下の様にストレージ情報を修正しなければならない。
* NFS プラグインタイプのストレージが拡張された場合は、ストレージの総容量の値を変更する
* NFS Named タイプの場合、容量の値を変更する

次のサービスでボリュームのリクエスト量情報を変更すると、ワークロードを拡張されたストレージ容量を使用することができる。NFS の場合は、ワークロードを再起動する必要がない。